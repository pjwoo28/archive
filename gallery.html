<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jeongwoo's Archives</title>
  <link rel="stylesheet" href="gallery.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"/>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto&display=swap"/>

</head>
<body>
  <div class="background-image"></div>
  <div class="background-box"></div>
  <div class="container">
    <div class="archive-box">
      <h1 class="archive-title">Jeongwoo's Archives</h1>
        <div class="folder">
            <div class="folder-content">
              <span class="folder-icon"><i class="fas fa-folder"></i></span>
            </div>
        </div>
    </div>
    <div class="search-container">
      <div class="search-wrapper">
        <input type="text" class="search-bar" placeholder="Search">
        <span class="search-icon"><i class="fas fa-search"></i></span>
        <span class="sort-icon"><i class="fas fa-sort"></i></span>
        <div class="dropdown">
          <div class="dropdown-content" id="sortDropdown">
            <div class="dropdown-item oldest-item divider-line">Oldest</div>
            <div class="dropdown-item newest-item divider-line">Newest</div>
            <div class="dropdown-item from-twitter divider-line">From Twitter</div>
            <div class="dropdown-item from-instagram divider-line">From Instagram</div>
            <div class="dropdown-item from-weverse">From Weverse</div>
          </div>
        </div>
      </div>
    </div>
    <div class="images-box">
      <div class="image-container"></div>
    </div>
  </div>
  <script>
    const folderIcons = document.querySelectorAll('.folder-icon i');
    const searchContainer = document.querySelector('.search-container');
    let activeIcon = null;

    const twitterImages = [
      { url: "twitter/twt1.jpeg", date: "2024-04-21", caption: "hyunsuk's 2024 birthday", link: "https://x.com/treasuremembers/status/1781705171917230552" },
      { url: "twitter/twt2.jpeg", date: "2024-01-07", caption: "fukuoka concert", link: "https://x.com/treasuremembers/status/1743900347301822727" },
    ];

    folderIcons.forEach((icon, index) => {
      icon.addEventListener('click', () => {
        searchContainer.style.display = 'block';
        if (icon === activeIcon) {
          document.querySelector('.image-container').innerHTML = '';
          document.querySelector('.images-box').style.display = 'none';
          searchContainer.style.display = 'none';
          activeIcon.classList.remove('fa-folder-open');
          activeIcon.classList.add('fa-folder');
          activeIcon = null;
        } else {
          if (activeIcon) {
            activeIcon.classList.remove('fa-folder-open');
            activeIcon.classList.add('fa-folder');
          }
          icon.classList.remove('fa-folder');
          icon.classList.add('fa-folder-open');
          activeIcon = icon;

          document.querySelector('.image-container').innerHTML = '';
          document.querySelector('.images-box').style.display = 'block';

          switch (index) {
            case 0:
              twitterImages.forEach(imageData => {
                const container = document.createElement('div');
                container.classList.add('image-caption-container');
                const image = document.createElement('img');
                image.src = imageData.url;
                image.setAttribute('data-date', imageData.date);
                container.appendChild(image);
                const captionContainer = document.createElement('div');
                captionContainer.classList.add('caption-container');
                const caption = document.createElement('span');
                caption.classList.add('image-caption');
                caption.textContent = imageData.caption;
                captionContainer.appendChild(caption);
                const imageCaptionSortIcon = document.createElement('i');
                imageCaptionSortIcon.classList.add('image-sort-icon', 'fas', 'fa-sort');
                captionContainer.appendChild(imageCaptionSortIcon);
                container.appendChild(captionContainer);
                document.querySelector('.image-container').appendChild(container);
              });
              break;
          }
        }
      });
    });

    const searchBar = document.querySelector('.search-bar');
    const sortIcon = document.querySelector('.sort-icon i');
    const searchIcon = document.querySelector('.search-icon i');
    const dropdown = document.querySelector('.dropdown');

    searchBar.addEventListener('input', () => {
      sortIcon.classList.toggle('fa-times', searchBar.value.trim() !== '');
    });

    sortIcon.addEventListener('click', () => {
      dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    });

    searchIcon.addEventListener('click', () => {
      document.querySelector('.image-container').innerHTML = '';
      const searchTerm = searchBar.value.trim().toLowerCase();
      if (searchTerm) {
        const images = Array.from(document.querySelectorAll('.image-container img'));
        images.forEach(image => {
          const caption = image.parentElement.querySelector('.image-caption').textContent.toLowerCase();
          if (caption.includes(searchTerm)) {
            image.parentElement.style.display = 'block';
          } else {
            image.parentElement.style.display = 'none';
          }
        });
      } else {
        document.querySelectorAll('.image-caption-container').forEach(container => {
          container.style.display = 'block';
        });
      }
    });

    window.addEventListener('click', event => {
      if (!event.target.matches('.sort-icon i, .dropdown, .dropdown *')) {
        dropdown.style.display = 'none';
      }
    });

    const sortImages = (criteria) => {
      const imageContainers = Array.from(document.querySelectorAll('.image-caption-container'));
      switch (criteria) {
        case 'oldest':
          imageContainers.sort((a, b) => new Date(a.querySelector('img').getAttribute('data-date')) - new Date(b.querySelector('img').getAttribute('data-date')));
          break;
        case 'newest':
          imageContainers.sort((a, b) => new Date(b.querySelector('img').getAttribute('data-date')) - new Date(a.querySelector('img').getAttribute('data-date')));
          break;
      }
      const imageContainer = document.querySelector('.image-container');
      imageContainer.innerHTML = '';
      imageContainers.forEach(container => imageContainer.appendChild(container));
    };

    const sortDropdownItems = document.querySelectorAll('.dropdown-item');
    sortDropdownItems.forEach(item => {
      item.addEventListener('click', () => {
        sortImages(item.textContent.toLowerCase());
        dropdown.style.display = 'none';
      });
    });
  </script>
</body>
</html>
